// Code generated by generate_visitor_callbacks.py; DO NOT EDIT.
// Generator: scripts/generate_visitor_callbacks.py
// Schema: crates/html-to-markdown-ffi/visitor_callbacks.yaml
// Template: crates/html-to-markdown-ffi/templates/csharp_bridge_callbacks.cs.j2

using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;

namespace HtmlToMarkdown.Visitor;

/// <summary>
/// Generated visitor callback bridge methods.
/// This partial class contains the callback implementations that marshal between native and managed code.
/// </summary>
internal partial class VisitorBridge
{
    /// <summary>
    /// Called before entering any HTML element (pre-order traversal)
    /// </summary>
    /// <remarks>
    /// HTML elements: All elements<br/>
    /// Frequency: high
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitElementStartCallback(
        IntPtr userData,
        IntPtr ctx)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitElementStart(
                context);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitElementStart error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for line break elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <br>, <br/><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitLineBreakCallback(
        IntPtr userData,
        IntPtr ctx)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitLineBreak(
                context);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitLineBreak error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for horizontal rule elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <hr>, <hr/><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitHorizontalRuleCallback(
        IntPtr userData,
        IntPtr ctx)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitHorizontalRule(
                context);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitHorizontalRule error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called before processing a table element
    /// </summary>
    /// <remarks>
    /// HTML elements: <table><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitTableStartCallback(
        IntPtr userData,
        IntPtr ctx)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitTableStart(
                context);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitTableStart error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called before processing a definition list
    /// </summary>
    /// <remarks>
    /// HTML elements: <dl><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitDefinitionListStartCallback(
        IntPtr userData,
        IntPtr ctx)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitDefinitionListStart(
                context);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitDefinitionListStart error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called before processing a figure element
    /// </summary>
    /// <remarks>
    /// HTML elements: <figure><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitFigureStartCallback(
        IntPtr userData,
        IntPtr ctx)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitFigureStart(
                context);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitFigureStart error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for each text node in the HTML document
    /// </summary>
    /// <remarks>
    /// HTML elements: Text nodes<br/>
    /// Frequency: very_high
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitTextCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitText(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitText error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for strong/bold elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <strong>, <b><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitStrongCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitStrong(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitStrong error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for emphasis/italic elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <em>, <i><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitEmphasisCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitEmphasis(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitEmphasis error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for strikethrough elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <s>, <del>, <strike><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitStrikethroughCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitStrikethrough(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitStrikethrough error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for underline elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <u>, <ins><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitUnderlineCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitUnderline(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitUnderline error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for subscript elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <sub><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitSubscriptCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitSubscript(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitSubscript error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for superscript elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <sup><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitSuperscriptCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitSuperscript(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitSuperscript error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for mark/highlight elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <mark><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitMarkCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitMark(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitMark error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for inline code elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <code><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitCodeInlineCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr code)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var codeStr = PtrToStringUtf8(code) ?? "";
            var result = _visitor.VisitCodeInline(
                context, codeStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitCodeInline error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called after exiting any HTML element (post-order traversal)
    /// </summary>
    /// <remarks>
    /// HTML elements: All elements<br/>
    /// Frequency: high
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitElementEndCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr output)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var outputStr = PtrToStringUtf8(output) ?? "";
            var result = _visitor.VisitElementEnd(
                context, outputStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitElementEnd error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called after processing a table element
    /// </summary>
    /// <remarks>
    /// HTML elements: </table><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitTableEndCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr output)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var outputStr = PtrToStringUtf8(output) ?? "";
            var result = _visitor.VisitTableEnd(
                context, outputStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitTableEnd error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for definition term elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <dt><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitDefinitionTermCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitDefinitionTerm(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitDefinitionTerm error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for definition description elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <dd><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitDefinitionDescriptionCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitDefinitionDescription(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitDefinitionDescription error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called after processing a definition list
    /// </summary>
    /// <remarks>
    /// HTML elements: </dl><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitDefinitionListEndCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr output)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var outputStr = PtrToStringUtf8(output) ?? "";
            var result = _visitor.VisitDefinitionListEnd(
                context, outputStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitDefinitionListEnd error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for summary elements inside details
    /// </summary>
    /// <remarks>
    /// HTML elements: <summary><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitSummaryCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitSummary(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitSummary error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for figcaption elements inside figure
    /// </summary>
    /// <remarks>
    /// HTML elements: <figcaption><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitFigCaptionCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitFigCaption(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitFigCaption error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for anchor links
    /// </summary>
    /// <remarks>
    /// HTML elements: <a href="..."><br/>
    /// Frequency: high
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitLinkCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr href, IntPtr text, IntPtr title)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var hrefStr = PtrToStringUtf8(href) ?? "";
            var textStr = PtrToStringUtf8(text) ?? "";
            var titleStr = title != IntPtr.Zero ? PtrToStringUtf8(title) : null;
            var result = _visitor.VisitLink(
                context, hrefStr, textStr, titleStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitLink error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for image elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <img src="..." alt="..."><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitImageCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr src, IntPtr alt, IntPtr title)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var srcStr = PtrToStringUtf8(src) ?? "";
            var altStr = PtrToStringUtf8(alt) ?? "";
            var titleStr = title != IntPtr.Zero ? PtrToStringUtf8(title) : null;
            var result = _visitor.VisitImage(
                context, srcStr, altStr, titleStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitImage error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for code block elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <pre><code><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitCodeBlockCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr lang, IntPtr code)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var langStr = lang != IntPtr.Zero ? PtrToStringUtf8(lang) : null;
            var codeStr = PtrToStringUtf8(code) ?? "";
            var result = _visitor.VisitCodeBlock(
                context, langStr, codeStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitCodeBlock error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for list item elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <li><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitListItemCallback(
        IntPtr userData,
        IntPtr ctx, bool ordered, IntPtr marker, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var markerStr = PtrToStringUtf8(marker) ?? "";
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitListItem(
                context, ordered, markerStr, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitListItem error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called after processing a list element
    /// </summary>
    /// <remarks>
    /// HTML elements: </ul>, </ol><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitListEndCallback(
        IntPtr userData,
        IntPtr ctx, bool ordered, IntPtr output)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var outputStr = PtrToStringUtf8(output) ?? "";
            var result = _visitor.VisitListEnd(
                context, ordered, outputStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitListEnd error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for blockquote elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <blockquote><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitBlockquoteCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr content, nuint depth)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var contentStr = PtrToStringUtf8(content) ?? "";
            var result = _visitor.VisitBlockquote(
                context, contentStr, (int)depth);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitBlockquote error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for custom or unknown HTML elements
    /// </summary>
    /// <remarks>
    /// HTML elements: Unknown elements<br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitCustomElementCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr tag_name, IntPtr content)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var tag_nameStr = PtrToStringUtf8(tag_name) ?? "";
            var contentStr = PtrToStringUtf8(content) ?? "";
            var result = _visitor.VisitCustomElement(
                context, tag_nameStr, contentStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitCustomElement error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for form elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <form><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitFormCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr action, IntPtr method)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var actionStr = action != IntPtr.Zero ? PtrToStringUtf8(action) : null;
            var methodStr = method != IntPtr.Zero ? PtrToStringUtf8(method) : null;
            var result = _visitor.VisitForm(
                context, actionStr, methodStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitForm error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for input form elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <input><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitInputCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr input_type, IntPtr name, IntPtr value)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var input_typeStr = input_type != IntPtr.Zero ? PtrToStringUtf8(input_type) : null;
            var nameStr = name != IntPtr.Zero ? PtrToStringUtf8(name) : null;
            var valueStr = value != IntPtr.Zero ? PtrToStringUtf8(value) : null;
            var result = _visitor.VisitInput(
                context, input_typeStr, nameStr, valueStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitInput error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for button elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <button><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitButtonCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr text)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var result = _visitor.VisitButton(
                context, textStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitButton error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for audio elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <audio><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitAudioCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr src)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var srcStr = src != IntPtr.Zero ? PtrToStringUtf8(src) : null;
            var result = _visitor.VisitAudio(
                context, srcStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitAudio error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for video elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <video><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitVideoCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr src)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var srcStr = src != IntPtr.Zero ? PtrToStringUtf8(src) : null;
            var result = _visitor.VisitVideo(
                context, srcStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitVideo error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for iframe elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <iframe><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitIFrameCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr src)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var srcStr = src != IntPtr.Zero ? PtrToStringUtf8(src) : null;
            var result = _visitor.VisitIFrame(
                context, srcStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitIFrame error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for heading elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <h1> through <h6><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitHeadingCallback(
        IntPtr userData,
        IntPtr ctx, uint level, IntPtr text, IntPtr id)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var textStr = PtrToStringUtf8(text) ?? "";
            var idStr = id != IntPtr.Zero ? PtrToStringUtf8(id) : null;
            var result = _visitor.VisitHeading(
                context, (int)level, textStr, idStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitHeading error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called before processing a list element
    /// </summary>
    /// <remarks>
    /// HTML elements: <ul>, <ol><br/>
    /// Frequency: medium
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitListStartCallback(
        IntPtr userData,
        IntPtr ctx, bool ordered)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitListStart(
                context, ordered);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitListStart error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for table row elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <tr><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitTableRowCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr cells,
        nuint cellsCount, bool is_header)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var cellsList = new List<string>();
            if (cells != IntPtr.Zero)
            {
                for (nuint i = 0; i < cellsCount; i++)
                {
                    var cellPtrPtr = IntPtr.Add(cells, (int)i * IntPtr.Size);
                    var cellPtr = Marshal.ReadIntPtr(cellPtrPtr);
                    var cellStr = PtrToStringUtf8(cellPtr) ?? "";
                    cellsList.Add(cellStr);
                }
            }
            var result = _visitor.VisitTableRow(
                context, cellsList.AsReadOnly(), is_header);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitTableRow error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called for details/disclosure elements
    /// </summary>
    /// <remarks>
    /// HTML elements: <details><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitDetailsCallback(
        IntPtr userData,
        IntPtr ctx, bool open)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var result = _visitor.VisitDetails(
                context, open);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitDetails error: {ex.Message}"));
        }
    }

    /// <summary>
    /// Called after processing a figure element
    /// </summary>
    /// <remarks>
    /// HTML elements: </figure><br/>
    /// Frequency: low
    /// </remarks>
    private NativeVisitorStructures.NativeVisitResult VisitFigureEndCallback(
        IntPtr userData,
        IntPtr ctx, IntPtr output)
    {
        try
        {
            var context = UnmarshalNodeContext(ctx);
            var outputStr = PtrToStringUtf8(output) ?? "";
            var result = _visitor.VisitFigureEnd(
                context, outputStr);
            return MarshalVisitResult(result);
        }
        catch (Exception ex)
        {
            return MarshalVisitResult(VisitResult.Error($"VisitFigureEnd error: {ex.Message}"));
        }
    }

}
